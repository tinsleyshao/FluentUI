%% 生成标准测试数据的脚本
%% 基于IEEE 14节点系统

function generate_test_data()
    % IEEE 14节点母线数据
    % 列: ID, 类型, Pd, Qd, Gs, Bs, V_base
    bus_data = [
        1  3   0.00   0.00  0.0  0.0  1.06000;
        2  2   0.217  0.127 0.0  0.0  1.04500;
        3  2   0.942  0.301 0.0  0.0  1.00700;
        4  1   0.478 -0.039 0.0  0.0  1.00700;
        5  1   0.760  0.160 0.0  0.0  1.00600;
        6  2   1.120  0.750 0.0  0.0  1.07000;
        7  1   0.000  0.000 0.0  0.0  1.06100;
        8  2   0.300  0.161 0.0  0.0  1.09000;
        9  1   0.290  0.165 0.0  0.0  1.05620;
       10  1   0.090  0.058 0.0  0.0  1.05100;
       11  1   0.035  0.018 0.0  0.0  1.05700;
       12  1   0.061  0.016 0.0  0.0  1.05500;
       13  1   0.135  0.058 0.0  0.0  1.05040;
       14  1   0.149  0.050 0.0  0.0  1.03590
    ];
    
    % IEEE 14节点线路数据
    % 列: 始端, 末端, 电阻, 电感, 并联容纳
    line_data = [
         1   2  0.01938  0.05917  0.0528;
         1   5  0.05403  0.22304  0.0492;
         2   3  0.04699  0.19797  0.0438;
         2   4  0.05811  0.17632  0.0340;
         2   5  0.05695  0.17388  0.0346;
         3   4  0.06701  0.17103  0.0128;
         4   5  0.01335  0.04211  0.0000;
         4   7  0.00000  0.20912  0.0000;
         4   9  0.00000  0.55618  0.0000;
         5   6  0.00000  0.25202  0.0000;
         6  11  0.09498  0.19890  0.0000;
         6  12  0.12291  0.25581  0.0000;
         6  13  0.06615  0.13027  0.0000;
         7   8  0.00000  0.17615  0.0000;
         7   9  0.00000  0.11001  0.0000;
         9  10  0.03181  0.08450  0.0000;
         9  14  0.12711  0.27038  0.0000;
        10  11  0.08205  0.19207  0.0000;
        12  13  0.22092  0.19988  0.0000;
        13  14  0.17093  0.34802  0.0000
    ];
    
    % 保存为MAT文件
    save('ieee14_bus.mat', 'bus_data', 'line_data');
    
    % 也保存为JSON格式 (可选)
    % 注: 需要MATLAB R2016b或以上版本
    
    disp('测试数据生成完成！');
    disp('  - ieee14_bus.mat 包含:');
    disp(sprintf('    节点数: %d', size(bus_data, 1)));
    disp(sprintf('    线路数: %d', size(line_data, 1)));
end

% 运行脚本
generate_test_data();
